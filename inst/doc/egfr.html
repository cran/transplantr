<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Estimated GFR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimated GFR</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Glomerular filtration rate can only be determined accurately by direct measurement of renal clearance of markers such as inulin, <sup>51</sup>Cr-EDTA, <sup>125</sup>I-iothalamate or iohexol, but GFR can be estimated from serum creatinine using a number of established formulae. There is no perfect formula for all levels of renal function, and all formulae can be inaccurate if renal function is unstable, at extremes of BMI, in pregnancy, muscle wasting or gross oedema.</p>
<p>The <strong>CKD-EPI</strong>(<em>1</em>) and abbreviated <strong>MDRD</strong>(<em>2</em>) formulae are the ones most commonly used for adults, and are both based on large numbers of patients with direct GFR measurement and standardised serum creatinine measurements using isotope dilution mass spectrometry. The CKD-EPI formula is more accurate for patients with GFR greater than 60 ml/min, although as both formulae are based on regression splines, neither is accurate for GFR greater than 90ml/min. The MDRD formula was updated in 2005, and this later revision is used in this package. The CKD-EPI formula was recommended for estimation of GFR in adults in NICE Clinical Guideline 128 (2014). In the USA, the MDRD formula was recommended in NKF-KDOQI 2002, and the CKD-EPI formula recommended by KDIGO 2013. Both produce an estimate of GFR for a patient with body surface area of 1.73m<sup>2</sup>.</p>
<p>The bedside <strong>Schwartz</strong>(<em>3</em>) formula is more accurate in children, and recommended for GFR estimation in patients under 19 by the National Kidney Federation and National Kidney Disease Education Program in the USA.</p>
<p>The <strong>Cockcroft-Gault</strong>(<em>4</em>) equation estimates creatinine clearance rather than GFR and tends to overestimate actual GFR as creatinine is cleared from the kidney by tubular secretion as well as glomerular filtration. It is still widely used for renal drug dosing, although the National Kidney Federation in the USA recommend CKD-EPI or MDRD instead.</p>
<p>Results from eGFR calculators may vary due rounding errors. The functions in the <em>transplantr</em> package convert creatinine units as 1.00 mg/dl being equal to 88.4 µmol/l</p>
<p>I find the functions are easiest to use with <em>dplyr</em>, using the <code>mutate()</code> verb inside a pipe.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(transplantr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a></code></pre></div>
</div>
<div id="ckd-epi-formula" class="section level1">
<h1>CKD-EPI formula</h1>
<p>The CKD-EPI formula eGFR is calculated from age, sex and ethnicity as well as serum creatinine. The basic function to return its value is <code>ckd_epi()</code> which takes creatinine in either µmol/l (by default) or mg/dl, age in years, sex as <code>0</code> for female or <code>1</code> for male, and ethnicity as <code>&quot;black&quot;</code> or <code>&quot;non-black&quot;</code>. The <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>&quot;SI&quot;</code> for µmol/l or <code>&quot;US&quot;</code> for mg/dl; if the parameter is not provided, it defaults to <code>&quot;SI&quot;</code>.</p>
<p>There is also a <code>ckd_epi_US()</code> wrapper function which uses mg/dl as the creatinine unit. This is quicker to type than <code>ckd_epi(..., units = &quot;US&quot;)</code> but is very fractionally slower.</p>
<p>This is a vectorised function, which takes numeric vectors as its input and returns a numeric vector. I would typically call the function from within a <code>mutate()</code> call in a <em>dplyr</em> pipe, which adds a new variable to the dataframe:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(results)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">results2 &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw">ckd_epi</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">results2</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; # A tibble: 4 x 7</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;   Creatinine   Age Sex   Ethnicity Weight Height  eGFR</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 1        101    45 M     non-black     71    177  77.0</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 2        201    65 F     non-black     54    154  21.9</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 3        301    72 M     black         81    183  19.7</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; 4        450    54 F     black         85    165  10.3</span></a></code></pre></div>
<p>If creatinine is measured in mg/dl, the variant code would be one of these two alternatives:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data</span>(results_US)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># using the standard function</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">results_US2 &lt;-<span class="st"> </span>results_US <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw">ckd_epi</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">        <span class="dt">eth =</span> Ethnicity, <span class="dt">units =</span> <span class="st">&quot;US&quot;</span>))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># using the wrapper function</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">results_US3 &lt;-<span class="st"> </span>results_US <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw">ckd_epi_US</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">          <span class="dt">eth =</span> Ethnicity))</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">results_US2</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; # A tibble: 4 x 7</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;   Creatinine   Age Sex   Ethnicity Weight Height  eGFR</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; 1       1.14    45 M     non-black     71    177  77.0</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; 2       2.27    65 F     non-black     54    154  21.9</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; 3       3.40    72 M     black         81    183  19.7</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; 4       5.09    54 F     black         85    165  10.3</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">results_US3</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; # A tibble: 4 x 7</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;   Creatinine   Age Sex   Ethnicity Weight Height  eGFR</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; 1       1.14    45 M     non-black     71    177  77.0</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; 2       2.27    65 F     non-black     54    154  21.9</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; 3       3.40    72 M     black         81    183  19.7</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; 4       5.09    54 F     black         85    165  10.3</span></a></code></pre></div>
<p>If you don’t like <em>dplyr</em>, the functions also work well within Base R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mydata<span class="op">$</span>eGFR &lt;-<span class="st"> </span><span class="kw">ckd_epi</span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity)</a></code></pre></div>
<div id="calculating-serial-egfr-results" class="section level2">
<h2>Calculating serial eGFR Results</h2>
<p>In renal transplant follow-up, it is common to report eGFR at various timepoints, such as 1, 2 and 5 year eGFR. This is facilitated by the <code>ckd_epi()</code> function using the optional <code>offset</code> parameter which adds a year to the baseline age. For example, to calculate 1 and 5 year eGFR, the code would be something like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">data</span>(serial.results)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">serial.results2 &lt;-<span class="st"> </span>serial.results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR_1yr =</span> <span class="kw">ckd_epi</span>(<span class="dt">creat =</span> Creatinine_1yr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                    <span class="dt">eth =</span> Ethnicity, <span class="dt">offset =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">         <span class="dt">eGFR_5yr =</span> <span class="kw">ckd_epi</span>(<span class="dt">creat =</span> Creatinine_5yr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">                    <span class="dt">eth =</span> Ethnicity, <span class="dt">offset =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">serial.results2</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; # A tibble: 4 x 7</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;     Age Sex   Ethnicity Creatinine_1yr Creatinine_5yr eGFR_1yr eGFR_5yr</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 1    45 M     non-black            110            115    69.0     63.6 </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 2    65 F     non-black            220            201    19.5     21.1 </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 3    72 M     black                270            250    22.3     23.8 </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 4    54 F     black                477            501     9.57     8.77</span></a></code></pre></div>
</div>
</div>
<div id="abbreviated-mdrd-formula" class="section level1">
<h1>Abbreviated MDRD formula</h1>
<p>Using abbreviated MDRD formula eGFR is also calculated from age, sex and ethnicity as well as serum creatinine. The basic function to return its value is <code>mdrd()</code> which takes creatinine in either µmol/l (by default) or mg/dl, age in years, sex as <code>0</code> for female or <code>1</code> for male, and ethnicity as <code>&quot;black&quot;</code> or <code>&quot;non-black&quot;</code>. The <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>&quot;SI&quot;</code> for µmol/l or <code>&quot;US&quot;</code> for mg/dl; if the parameter is not provided, it defaults to <code>&quot;SI&quot;</code>.</p>
<p>Like CKD-EPI function, there is also a <code>mdrd_US()</code> wrapper function which uses mg/dl as the creatinine unit.</p>
<p>This is also vectorised function, and is generally called from within a <code>mutate()</code> call in a <em>dplyr</em> pipe:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">results2m &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw">mdrd</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity))</a></code></pre></div>
<p>Using mg/dl as units or base R work in the same way as the <code>ckd_epi()</code> formula, and the <code>mdrd()</code> can also accept an optional <code>offset</code> parameter to facilitate serial results.</p>
<p>There is also a fuller six-variable MDRD formula which may be added to this package in the future. The six-variable formula includes albumin and either urea or blood urea nitrogen (BUN).</p>
</div>
<div id="schwartz-formula" class="section level1">
<h1>Schwartz formula</h1>
<p>The bedside Schwartz formula is used for children under 19 and is a simpler version of the original Schwartz formula published in 1984. It is calculated using the <code>schwartz()</code> function and uses serum creatinine in either µmol/l (by default) or mg/dl and height in cm. Like the other formulae in the package, the <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>&quot;SI&quot;</code> for µmol/l or <code>&quot;US&quot;</code> for mg/dl; if the parameter is not provided, it defaults to <code>&quot;SI&quot;</code>. There is also a <code>schwartz_US()</code> wrapper function which uses mg/dl.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">results2p &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw">schwartz</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">height =</span> Height))</a></code></pre></div>
<p>In the same way as the CKD-EPI and MDRD functions, using the optional offset parameter helps to generate serial results.</p>
</div>
<div id="cockcroft-gault-formula" class="section level1">
<h1>Cockcroft-Gault formula</h1>
<p>The Cockcroft-Gault formula provides a reasonably accurate estimation of creatinine clearance, but this is <em>not</em> the same as glomerular filtration as creatinine is also cleared by tubular secretion, and so the equation tends to overestimate GFR by up to 25%. It is still used in renal dose calculations in the UK, although the US guidance is to use CKD-EPI or MDRD instead. It is also worth noting that the methodology from which it was derived assumes ideal body weight.</p>
<p>In the <em>transplantr</em> package, the creatinine clearance can be calculated with the <code>cockcroft()</code> function, which takes creatinine, age, sex and weight as core arguments. The creatinine is in µmol/l by default, but can be changed to mg/dl either by specifying <code>units</code> to be <code>&quot;US&quot;</code> or by calling the wrapper function <code>cockcroft_US()</code>. Ideal body weight can be calculated from height and sex using the <code>ibw()</code> function. An example using a <em>dplyr</em> pipe:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">results2cg &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ideal.Weight =</span> <span class="kw">ibw</span>(<span class="dt">height =</span> Height, <span class="dt">sex =</span> Sex),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">         <span class="dt">CrClear =</span> <span class="kw">cockcroft</span>(<span class="dt">creat =</span> Creatinine, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                             <span class="dt">weight =</span> Ideal.Weight))</a></code></pre></div>
</div>
<div id="formulae-to-be-added-in-future" class="section level1">
<h1>Formulae to be added in future</h1>
<p>The <strong>Nankivell</strong> and <strong>Walser</strong> formulae are less commonly used. The Nankivell formula is the only eGFR formula derived entirely from renal transplant patients, but included patients with unstable GFR. The Nankivell formula includes weight and height so approximates an absolute GFR. The Walser formula produces a result standardised to a height-squared of 3m<sup>2</sup>.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ol style="list-style-type: decimal">
<li><p>Levey AS, Stevens LA, Schmid CH, et al. for the CKD-EPI (Chronic Kidney Disease Epidemiology Collaboration). A new equation to estimate glomerular filtration rate. <em>Ann Intern Med</em> 2009; 150(9):604-612. DOI: <a href="https://doi.org/10.7326/0003-4819-150-9-200905050-00006">10.7326/0003-4819-150-9-200905050-00006</a></p></li>
<li><p>Levey AS, Greene T, Kusek JW, et al. A simplified equation to predict glomerular filtration rate from serum creatinine. <em>J Am Soc Nephrol</em> 2000; 11:A0828.</p></li>
<li><p>Schwartz GJ, Munoz A, Schneider MF et al. New equations to estimate GFR in children with CKD. <em>J Am Soc Nephrol</em> 2009; 20(3):629-637. DOI: <a href="https://doi.org/10.1681/ASN.2008030287">10.1681/ASN.2008030287</a></p></li>
<li><p>Cockcroft DW, Gault MH. Prediction of creatinine clearance from serum creatinine. <em>Nephron</em> 1976; 16(1):31-41. DOI: <a href="https://doi.org/10.1159/000180580">10.1159/000180580</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
